global:
  scrape_interval: 15s     # Интервал сбора метрик
  evaluation_interval: 15s # Интервал проверки правил алертов

alerting:
  alertmanagers:
  - static_configs:
    - targets: ['localhost:9093']

rule_files:
  - "alert_rules.yml"

scrape_configs:
  # === 1. ИНФРАСТРУКТУРА (СЕРВЕРЫ И ЯДРО МОНИТОРИНГА) ===

  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'linux-node'
    static_configs:
      - targets: ['localhost:9100']
        labels:
          instance: 'monitoring-server'
          os: 'linux'

      # Пример мониторинга удаленного сервера:
      # - targets: ['remoteip:9100']
      #   labels:
      #     instance: 'vps'
      #     os: 'linux'  

  - job_name: 'cadvisor'
    static_configs:
      - targets: ['localhost:8080']
        labels:
          instance: 'monitoring-server'
          type: 'container-stats'

  # Пример мониторинга Windows-серверов (требует установки windows_exporter):
  # - job_name: 'windows-nodes'
  #   static_configs:
  #     - targets: ['192.168.1.10:9182']
  #       labels:
  #         instance: 'win-1'
  #         os: 'windows'
  #     - targets: ['192.168.1.11:9182']
  #       labels:
  #         instance: 'win-2'
  #         os: 'windows'

  # === 2. СЕРВИСЫ (БАЗЫ ДАННЫХ И ПРОКСИ) ===

  - job_name: 'nginx'
    static_configs:
      - targets: ['localhost:9113'] 

  - job_name: 'postgres'
    static_configs:
      - targets: ['localhost:9187']

  # === 3. ПРИЛОЖЕНИЯ (БИЗНЕС-ЛОГИКА) ===

  - job_name: 'python-app'
    static_configs:
      - targets: ['localhost:8000']