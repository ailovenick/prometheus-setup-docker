# FROM: Определение базового образа (Base Image) для построения контейнера.
# python:3.11-slim — официальный образ Python версии 3.11.
# Суффикс "-slim" — облегченная версия (минимальный размер), без лишних системных утилит.
FROM python:3.11-slim

# WORKDIR: Создание рабочей директории внутри контейнера и переход в нее.
# Выполнение последующих команд (COPY, RUN, CMD) относительно этой директории.
WORKDIR /app

# RUN: Выполнение команды в консоли внутри контейнера на этапе сборки (Build time).
# pip install — установка необходимых Python-библиотек:
# fastapi (фреймворк), uvicorn (веб-сервер), prometheus-client (клиент для метрик).
RUN pip install fastapi uvicorn prometheus-client

# COPY: Копирование файлов с хост-машины внутрь контейнера.
# Синтаксис: COPY <источник> <назначение>.
# "app.py" — исходный файл приложения.
# "." — текущая директория контейнера (/app, согласно WORKDIR).
COPY app.py .

# CMD: Команда по умолчанию при запуске контейнера (Runtime).
# uvicorn — запуск высокопроизводительного ASGI веб-сервера.
# app:app — путь к приложению: <имя_файла>:<имя_объекта_приложения>.
# --host 0.0.0.0 — прослушивание всех сетевых интерфейсов.
# --port 8000 — порт сервера внутри контейнера.
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]