# FROM: Указываем базовый образ (Base Image), на основе которого строится наш контейнер.
# python:3.11-slim — это официальный образ Python версии 3.11.
# Суффикс "-slim" означает урезанную версию (меньше размер), без лишних системных утилит.
FROM python:3.11-slim

# WORKDIR: Создает рабочую директорию внутри контейнера и переходит в нее.
# Все последующие команды (COPY, RUN, CMD) будут выполняться относительно этой папки.
WORKDIR /app

# RUN: Выполняет команду в консоли внутри контейнера на этапе сборки образа (Build time).
# pip install — устанавливает необходимые Python-библиотеки из интернета:
# fastapi (сам фреймворк), uvicorn (веб-сервер для запуска), prometheus-client (для метрик).
RUN pip install fastapi uvicorn prometheus-client

# COPY: Копирует файлы с твоего компьютера (хост) внутрь контейнера.
# Синтаксис: COPY <откуда> <куда>.
# "app.py" — файл в папке проекта на твоем ПК.
# "." — текущая папка внутри контейнера (это /app, так как мы задали WORKDIR выше).
COPY app.py .

# CMD: Команда, которая выполняется ПО УМОЛЧАНИЮ при запуске контейнера (Runtime).
# uvicorn — запуск высокопроизводительного ASGI веб-сервера.
# app:app — указывает серверу, где искать приложение: <имя_файла_без_расширения>:<имя_переменной_FastAPI_внутри_кода>.
# --host 0.0.0.0 — слушать все сетевые интерфейсы.
# --port 8000 — порт внутри контейнера, на котором сервер ожидает соединения.
CMD ["uvicorn", "app:app", "--host", "0.0.0.0", "--port", "8000"]